# liza_trainer

学習部分をまとめたプロジェクトです。  
為替の1分足CSV (`timestamp,price`) を読み込み、単純に「k期間の価格変動からpr_k後が上昇(=1)か下降(=0)か」を推定する2値分類を行うサンプルを作成しています。

## ディレクトリ構成

- `main.py`  
  エントリーポイント。学習全体のフローを実行し、ベストモデルを保存します。  

- `modules/`  
  - `data_loader.py` : CSVを読み込み、価格データを配列として返す  
  - `dataset.py` : 特徴量/ラベルの作成、データの分割やクラスバランス調整  
  - `models.py` : ニューラルネットワークモデルの定義  
  - `trainer.py` : 学習ロジック全般を扱うクラス。  
    - バリデーションが改善しなくなった場合に重みを部分的に乱数で再初期化するなど、局所解回避ロジックを含む  
    - 最後にテストデータを評価し、それを複数回試行して最良モデルを保存する  

- `data/`  
  サンプルとして `sample_EURUSD_1m.csv` などを置く。

## 使い方

1. 必要なライブラリをインストールする
    ```bash
    pip install -r requirements.txt
    ```
    ※ 本リポジトリには `requirements.txt` は含んでいません。  
    以下のパッケージを最低限導入してください。  
    - numpy
    - pandas
    - tensorflow (あるいは tensorflow-cpu)
    - tqdm

2. `data` ディレクトリに `sample_XXXX_1m.csv` を配置する  
   CSVの中身は以下のようになっている必要があります。
    ```
    timestamp,price
    1579068180,1.11508
    1579068240,1.11509
    ...
    ```

3. `main.py` を実行する
    ```bash
    python main.py
    ```
    - 学習が走り、最後に `best_model_weights.h5` というファイルが出力されます。

## 補足

- 本プロジェクトは学習ロジックのみです。  
  シミュレーション（バックテスト）や実稼働（自動売買）部分は含んでいません。
- 「ランダムでも勝てる利確・損切りロジックをベースに、NNをさらに上積みする」 という全体コンセプトのうち、「学習パートとしてAIモデル構築と学習を自動化する部分」に特化しています。
- 本番稼働させる際は別途「実稼働用」「シミュレーター用」と組み合わせてご活用ください。
